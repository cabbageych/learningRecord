<!DOCTYPE html>
<html>

<head>
    <title>setAndMap</title>
    <style>
        #test {
            height: 100px;
            width: 100px;
            background: lightblue;
            border:2px solid yellow;  
        }
    </style>
</head>

<body>
    <div id="test" onclick="test()"></div>
    <button click="stop()">停止</button>
    <script>
        //offset获取的值除了width和height还包括border以及padding，并且使用offset相关值的获取，会导致reflow降低性能
        var timer;
        var t = document.getElementById("test");
        function change() {
            t.style.width = t.offsetWidth - 1 + 'px';   //长度不减反而增加
            return test();
        }
        function test() {
            timer = window.requestAnimationFrame(change);
        }
        function stop(){
            window.cancelAnimationFrame(timer);
        }
    </script>
</body>

</html>