<!DOCTYPE html>
<html>

<head>
    <title>case2</title>
    <style>
    </style>
</head>

<body>
    <canvas id="c1" height="300" width="300"></canvas>
    <div id="color" style="height: 100px;width: 100px;"></div>
    <canvas id="c2" height="300" width="300"></canvas>
    <canvas id="c3" height="300" width="300"></canvas>
    <canvas id="c4" height="300" width="300"></canvas>
    <canvas id="c5" height="150" width="150"></canvas>
    <canvas id="c6" height="150" width="150"></canvas>



    <script>
        let c1 = document.getElementById('c1');
        let c2 = document.getElementById('c2');
        let c3 = document.getElementById('c3');
        let c4 = document.getElementById('c4');
        let c5 = document.getElementById('c5');
        let c6 = document.getElementById('c6');



        let ctx1 = c1.getContext('2d');
        let img1 = new Image();
        img1.onload = function () {
            ctx1.drawImage(img1, 50, 50, 160, 160);
        }
        img1.src = "./IMG_20170425_164207.jpg";
        let color = document.getElementById('color');
        c1.addEventListener('mousemove', function (event) {
            let x = event.layerX;
            let y = event.layerY;

            let pixel = ctx1.getImageData(x, y, 1, 1);
            let data = pixel.data;
            let rgba = 'rgba(' + data[0] + ',' + data[1] + ',' + data[2] + ',' + data[3] + ')';
            color.style.background = rgba;
            color.innerHTML = rgba;
            //console.log(pixel);
        })

        ctx1.font = "30px serif";
        ctx1.fillText('imageData', 80, 250);


        //颜色反转
        let ctx2 = c2.getContext('2d');
        let img2 = new Image();
        img2.onload = function () {
            ctx2.drawImage(img2, 0, 50, 150, 150);
            let ImageData2 = ctx2.getImageData(0, 50, 150, 150);
            let data2 = ImageData2.data;
            for (let i = 0; i < data2.length; i += 4) {
                data2[i] = 255 - data2[i];
                data2[i + 1] = 255 - data2[i + 1];
                data2[i + 2] = 255 - data2[i + 2];
            }
            ctx2.putImageData(ImageData2, 150, 50);
        }
        img2.src = "./IMG_20170425_164207.jpg";

        ctx2.font = "30px serif";
        ctx2.fillText('invert', 80, 250);


        //灰度图
        let ctx3 = c3.getContext('2d');
        let img3 = new Image();
        img3.onload = function () {
            ctx3.drawImage(img3, 0, 50, 150, 150);
            let ImageData3 = ctx3.getImageData(0, 50, 150, 150);
            let data3 = ImageData3.data;
            for (let i = 0; i < data3.length; i += 4) {
                let avg = Math.floor((data3[i] + data3[i + 1] + data3[i + 2]) / 3);
                data3[i] = avg;
                data3[i + 1] = avg;
                data3[i + 2] = avg;
            }
            ctx3.putImageData(ImageData3, 150, 50);
        }
        img3.src = "./IMG_20170425_164207.jpg";
        ctx3.font = "30px serif";
        ctx3.fillText('grayscale', 80, 250);


        //缩放与反锯齿
        let ctx4 = c4.getContext('2d');
        let img4 = new Image();
        img4.onload = function () {
            ctx4.drawImage(img4, 0, 50, 150, 150);
            let ImageData4 = ctx4.getImageData(0, 50, 150, 150);

        }
        img4.src = "./IMG_20170425_164207.jpg";
        ctx4.font = "30px serif";
        ctx4.fillText('缩放与反锯齿', 80, 250);

        let ctx5 = c5.getContext('2d');
        let ctx6 = c6.getContext('2d');
        c4.addEventListener('mousemove', (event) => {
            let x = event.layerX;
            let y = event.layerY;
            ctx5.drawImage(c4, Math.abs(x - 5), Math.abs(y - 5), 10, 10, 0, 0, 150, 150);
            ctx6.imageSmoothingEnabled = false;
            ctx6.mozImageSmoothingEnabled = false;
            ctx6.webkitImageSmoothingEnabled = false;
            ctx6.msImageSmoothingEnabled = false;
            ctx6.drawImage(c4, Math.abs(x - 5), Math.abs(y - 5), 10, 10, 0, 0, 150, 150);
        });
    </script>
</body>

</html>