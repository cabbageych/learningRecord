<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>fileUpload</title>
    <style>
        #bar {
            position: relative;
            height: 30px;
            width: 0px;
            border: none;
            background: lightcoral;
            margin: 0;
            padding: 0;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div style="position:relative;margin:0 auto;text-align: center;margin-top:50px;">
        <input type="file" id="file"><button onclick="upload()">upload</button>
        <hr>
        <form>
            <label for="bar">上传进度</label>
            <input id="bar"></input><span id="showProgress"></span>
        </form>
    </div>
    <script>
        function upload() {
            var formData = new FormData();
            formData.append("file", document.getElementById('file').files[0]);
            //formData.append("token", token_value); // 其他参数按这样子加入

            var xhr = new XMLHttpRequest();

            // 上传完成后的回调函数
            xhr.onload = function () {
                if (xhr.status === 200) {
                    console.log('上传成功');
                } else {
                    console.log('上传出错');
                }
            };
            // 获取上传进度
            xhr.upload.onprogress = function (event) {
                if (event.lengthComputable) {
                    var percent = Math.floor(event.loaded / event.total * 100);
                    // 设置进度显示
                    //$("#J_upload_progress").progress('set progress', percent);
                    let bar = document.getElementById('bar');
                    let show = document.getElementById('showProgress');
                    bar.style.width = 200 * percent / 100 + 'px';
                    show.innerText = percent + "%";
                    console.log(percent);
                }
            };
            xhr.open('POST', 'http:localhost:8080');
            xhr.send(formData);
        }

    </script>
</body>

</html>